<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainfuck Translator (Modern)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Mengatur font default dan dark background */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background color */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }
        /* Style untuk area output */
        #outputArea {
            min-height: 100px;
            max-height: 400px;
        }

        /* Custom Modal Styles (Tailwind only) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: #1a202c;
            color: #e2e8f0;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            text-align: center;
            max-width: 300px;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        /* Spinner CSS (Menggunakan Tailwind Classes untuk animasi) */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #34d399; /* teal-400 */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="w-full max-w-xl bg-gray-800 p-6 sm:p-8 rounded-xl shadow-2xl mt-4 md:mt-10 border border-gray-700">
        <h1 class="text-3xl font-bold text-teal-400 mb-6 text-center">
            Brainfuck Translator
        </h1>

        <!-- Input Area -->
        <textarea id="inputText" rows="6"
            class="w-full bg-gray-900 text-gray-200 border border-gray-700 p-4 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-200 resize-y"
            placeholder="Tulis teks atau Brainfuck di sini..."></textarea>

        <!-- Buttons Group -->
        <div class="flex flex-col sm:flex-row gap-3 my-5">
            <button id="toBF"
                class="flex-1 bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-200 shadow-md transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-blue-500">
                Terjemahkan ke Brainfuck
            </button>
            <button id="toText"
                class="flex-1 bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-200 shadow-md transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-blue-500">
                Terjemahkan ke Teks
            </button>
            
            <button id="clearAll"
                class="sm:w-auto bg-gray-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-gray-700 transition duration-200 shadow-md transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-gray-500">
                Bersihkan
            </button>

            <button id="copyOutput"
                class="sm:w-auto bg-teal-500 text-gray-900 font-semibold py-3 px-4 rounded-lg hover:bg-teal-600 transition duration-200 shadow-md transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-teal-500">
                Copy Output
            </button>
        </div>

        <!-- Output Area -->
        <pre id="outputArea"
            class="bg-gray-700 text-gray-100 p-4 rounded-lg overflow-x-auto whitespace-pre-wrap text-sm border border-gray-600 flex justify-center items-center">
            Hasil Output Akan Muncul di Sini.
        </pre>

    </div>

    <!-- Custom Pop-up / Modal -->
    <div id="customModal" class="modal-overlay">
        <div class="modal-content">
            <div id="modalText" class="text-lg font-medium mb-1">Pesan</div>
            <div id="modalIcon" class="text-3xl"></div>
        </div>
    </div>

    <script>
        // --- Core Translation Logic ---
        function translateToBF(str) {
            let prev = 0;
            return Array.from(str).map(c => {
                const code = c.charCodeAt(0);
                const diff = code - prev;
                let bf = '';
                if (diff > 0) bf += '+'.repeat(diff);
                else if (diff < 0) bf += '-'.repeat(-diff);
                bf += '.';
                prev = code;
                return bf;
            }).join('\n');
        }

        function runBrainfuck(bf) {
            const cells = Array(30000).fill(0);
            let ptr = 0;
            let output = '';
            const bfArr = bf.split('');

            // Build bracket map
            const map = {};
            const tempStack = [];
            bfArr.forEach((c, i) => {
                if (c === '[') tempStack.push(i);
                else if (c === ']') {
                    const start = tempStack.pop();
                    map[start] = i;
                    map[i] = start;
                }
            });

            try {
                for (let i = 0; i < bfArr.length; i++) {
                    const c = bfArr[i];
                    if (c === '+') cells[ptr] = (cells[ptr] + 1) % 256;
                    else if (c === '-') cells[ptr] = (cells[ptr] - 1 + 256) % 256;
                    else if (c === '>') ptr++;
                    else if (c === '<') ptr--;
                    else if (c === '.') { output += String.fromCharCode(cells[ptr]); }
                    else if (c === '[' && cells[ptr] === 0) i = map[i];
                    else if (c === ']' && cells[ptr] !== 0) i = map[i];

                    // Simple loop limit to prevent freezing on invalid code 
                    if (i > 5000000) { 
                        throw new Error("Waktu eksekusi Brainfuck terlalu lama (kemungkinan loop tak terbatas/kode invalid).");
                    }
                }
            } catch (error) {
                return `[Error] ${error.message}`;
            }

            return output;
        }
        // --- End Core Logic ---

        const inputArea = document.getElementById('inputText');
        const outputArea = document.getElementById('outputArea');
        const customModal = document.getElementById('customModal');
        const modalText = document.getElementById('modalText');
        const modalIcon = document.getElementById('modalIcon');
        const toBFButton = document.getElementById('toBF');
        const toTextButton = document.getElementById('toText');
        const clearAllButton = document.getElementById('clearAll'); // New Element

        let dotInterval = null;
        let originalOutputContent = outputArea.innerHTML;

        // --- Custom Pop-up Functions ---

        function showModal(message, icon) {
            modalText.textContent = message;
            modalIcon.textContent = icon;
            customModal.style.display = 'flex';
        }

        function hideModal() {
            if (dotInterval) {
                clearInterval(dotInterval);
                dotInterval = null;
            }
            customModal.style.display = 'none';
        }

        function startWaitAnimation(baseText) {
            let dots = 1;
            modalIcon.textContent = '⏳';
            modalText.textContent = baseText + '.'.repeat(dots);

            dotInterval = setInterval(() => {
                dots = (dots % 3) + 1;
                modalText.textContent = baseText + '.'.repeat(dots);
            }, 300);
        }

        function setLoadingState(isLoading) {
            if (isLoading) {
                // Tampilkan spinner pada output area
                outputArea.classList.remove('justify-start', 'items-start');
                outputArea.classList.add('justify-center', 'items-center');
                outputArea.innerHTML = '<div class="flex flex-col items-center"><div class="spinner mb-2"></div><span class="text-gray-400">Memproses...</span></div>';
                
                // Nonaktifkan tombol
                toBFButton.disabled = true;
                toTextButton.disabled = true;
                clearAllButton.disabled = true;
                toBFButton.classList.add('opacity-50', 'cursor-not-allowed');
                toTextButton.classList.add('opacity-50', 'cursor-not-allowed');
                clearAllButton.classList.add('opacity-50', 'cursor-not-allowed');

            } else {
                // Hapus spinner dan kembalikan output area
                outputArea.classList.remove('justify-center', 'items-center');
                outputArea.classList.add('justify-start', 'items-start');

                // Aktifkan kembali tombol
                toBFButton.disabled = false;
                toTextButton.disabled = false;
                clearAllButton.disabled = false;
                toBFButton.classList.remove('opacity-50', 'cursor-not-allowed');
                toTextButton.classList.remove('opacity-50', 'cursor-not-allowed');
                clearAllButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        // --- Event Listeners ---

        document.getElementById('toBF').addEventListener('click', () => {
            setLoadingState(true);
            setTimeout(() => {
                const result = translateToBF(inputArea.value);
                outputArea.textContent = result || "Masukkan teks untuk diterjemahkan.";
                setLoadingState(false);
            }, 100); 
        });

        document.getElementById('toText').addEventListener('click', () => {
            setLoadingState(true);
            setTimeout(() => { 
                const result = runBrainfuck(inputArea.value);
                outputArea.textContent = result || "Masukkan kode Brainfuck untuk diterjemahkan.";
                setLoadingState(false);
            }, 100);
        });
        
        // New Clear All Listener
        document.getElementById('clearAll').addEventListener('click', () => {
            inputArea.value = '';
            outputArea.textContent = 'Hasil Output Akan Muncul di Sini.';
            outputArea.classList.remove('justify-center', 'items-center');
            outputArea.classList.add('justify-start', 'items-start');
            showModal('Input & Output Dibersihkan.', '✨');
            setTimeout(hideModal, 1500);
        });

        document.getElementById('copyOutput').addEventListener('click', async () => {
            const textToCopy = outputArea.textContent;

            if (textToCopy === 'Hasil Output Akan Muncul di Sini.' || textToCopy.trim() === '') {
                showModal('Tidak ada output untuk disalin.', '⚠️');
                setTimeout(hideModal, 1500);
                return;
            }

            // 1. Start "Wait..." animation
            startWaitAnimation('Menyalin');
            showModal('Menyalin', '⏳');

            try {
                // 2. Perform copy operation
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = textToCopy;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);

                // 3. Success: Stop animation, show success message
                clearInterval(dotInterval);
                dotInterval = null;
                showModal('Berhasil Disalin!', '✅');

            } catch (err) {
                // 4. Error: Stop animation, show error message
                clearInterval(dotInterval);
                dotInterval = null;
                console.error('Copy failed:', err);
                showModal('Gagal Menyalin. Coba lagi.', '❌');
            }

            // 5. Hide modal after 1.5 seconds
            setTimeout(hideModal, 1500);
        });

        // Set initial state for output area
        setLoadingState(false); 
        outputArea.innerHTML = originalOutputContent;

    </script>

</body>
</html>

    
